webpackJsonp([1],{0:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("//Fk"),n=a.n(s),r=a("7+uW"),o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"app"},[t("img",{staticClass:"img-fluid",attrs:{src:a("aRo5"),alt:"Takeaway.com logo"}}),this._v(" "),t("router-view")],1)},staticRenderFns:[]};var i=a("VU/8")({name:"App",data:function(){return{}}},o,!1,function(e){a("j3lA")},null,null).exports,u=a("mtWM"),l=a.n(u),c=a("/ocq"),m=a("Dd8w"),d=a.n(m),v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"game-settings-container"},[a("form",{on:{submit:function(e){e.preventDefault()}}},[a("div",{staticClass:"form-group group-style"},[a("button",{staticClass:"btn",class:{"btn-takeaway-primary":"auto"===e.style,"btn-takeaway-outlined-primary":"manual"===e.style},attrs:{type:"button"},on:{click:function(t){e.setGameStyle("auto")}}},[e._v("\n        Play Automatically\n      ")]),e._v(" "),a("button",{staticClass:"btn ",class:{"btn-takeaway-primary":"manual"===e.style,"btn-takeaway-outlined-primary":"auto"===e.style},attrs:{type:"button"},on:{click:function(t){e.setGameStyle("manual")}}},[e._v("\n        Manual Play\n      ")])]),e._v(" "),a("button",{staticClass:"btn btn-takeaway-action",on:{click:e.startGame}},[e._v("\n      Start Game!\n    ")])])])},staticRenderFns:[]};var p=a("VU/8")({name:"GameSettings",data:function(){return{style:"auto"}},methods:{startGame:function(){this.$emit("start_game",{style:this.style})},setGameStyle:function(e){this.style=e}},created:function(){}},v,!1,function(e){a("Zdlp")},"data-v-51b6a300",null).exports,h=a("Zrlr"),f=a.n(h),g=a("wxAW"),_=a.n(g),y=function(){function e(){f()(this,e)}return _()(e,null,[{key:"computeNextMoveNumber",value:function(e){if(e<=1)throw new Exception("Input number must be > 1, got: "+e);return(e+1)%3==0?(e+1)/3:e%3==0?e/3:(e-1)%3==0?(e-1)/3:void 0}},{key:"initiateNumber",value:function(){return e._getRandomInteger(20,100)}},{key:"_getRandomInteger",value:function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}}]),e}(),w=a("NYxO"),b=a("thjQ"),k=a.n(b),C={components:{GameSettings:p},name:"Application",data:function(){return{match:{match_id:null,player1:{id:null,username:null},player2:{id:null,username:null},number:0,currentTurnPlayer:{id:null,username:null},nextTurnPlayer:{id:null,username:null}},messages:[],moves:[],queued:!1,style:"auto",userId:null}},computed:d()({},Object(w.c)("user",{socket:"getSocket",user:"getUser"})),watch:{messages:function(e){e.length>3&&(this.messages=e.slice(0,3))}},methods:d()({},Object(w.d)("user",{initialize:"init",registerEvent:"registerSocketEvent",updateUser:"updateUserMatches"}),{startGame:function(e){var t=e.style;this.style=t,this.socket.emit("start_game")},updateTurn:function(e){this.moves.push(this._generateMoveMessage(e)),this.match.number=e;var t=this.match.currentTurnPlayer;this.match.currentTurnPlayer=this.match.nextTurnPlayer,this.match.nextTurnPlayer=t},_generateMoveMessage:function(e){if(this.match.number>0){var t=3*e-this.match.number;return{player:this.match.currentTurnPlayer.username,added:t,number:e}}return{player:this.match.currentTurnPlayer.username,added:0,number:e}},_openMoveModal:function(e){var t=this,a=void 0;a=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"Wrong choice! You must choose a number which can be divided by 3. You got "+e+". Pick a choice:":"It's your turn! You got "+e+". Pick a choice:",k()(a,{buttons:{add:{text:"Add 1",value:"add"},zero:{text:"Add nothing",value:"zero"},minus:{text:"Subtract 1",value:"minus"}}}).then(function(a){var s=void 0;switch(a){case"add":s=e+1;break;case"zero":s=e;break;case"minus":s=e-1;break;default:console.log("Wrong choice")}if(s%3!=0)return k()("error"),void t._openMoveModal(e,!0);var n=s/3;t.updateTurn(e),setTimeout(function(){t.socket.emit("next_move",{match_id:t.match.match_id,number:n})},500)})},_resetGame:function(){this.queued=!1,this.messages=[],this.moves=[],this.match={match_id:null,player1:{id:null,username:null},player2:{id:null,username:null},number:0,currentTurnPlayer:{id:null,username:null},nextTurnPlayer:{id:null,username:null}}}}),created:function(){var e=this;this.user||j.push({name:"Home"}),this.socket||this.initialize(localStorage.getItem("access_token")),this.registerEvent({event:"queued",callback:function(){e.queued=!0,e.messages.push("You have been queued, please wait")}}),this.registerEvent({event:"game_started",callback:function(t){e.messages.push("The game will soon start! Prepare yourself!!"),e.match=d()({},e.match,t),setTimeout(function(){e.messages=[]},2e3)}}),this.registerEvent({event:"first_turn",callback:function(t){var a=t.player;e.userId=a,e.match.player1.id===a?(e.match.nextTurnPlayer=e.match.player1,e.match.currentTurnPlayer=e.match.player2):(e.match.nextTurnPlayer=e.match.player2,e.match.currentTurnPlayer=e.match.player1);var s=y.initiateNumber();e.socket.emit("next_move",{match_id:e.match.match_id,number:s})}}),this.registerEvent({event:"first_turn_wait",callback:function(t){var a=t.player;e.userId=a,e.match.player1.id===a?(e.match.nextTurnPlayer=e.match.player2,e.match.currentTurnPlayer=e.match.player1):(e.match.nextTurnPlayer=e.match.player1,e.match.currentTurnPlayer=e.match.player2)}}),this.registerEvent({event:"next_move_announce",callback:function(t){var a=t.number,s=t.player;if(s===e.userId&&"auto"===e.style){var n=y.computeNextMoveNumber(a);e.updateTurn(a),setTimeout(function(){e.socket.emit("next_move",{match_id:e.match.match_id,number:n})},500)}else s===e.userId&&"manual"===e.style?e._openMoveModal(a):e.updateTurn(a)}}),this.registerEvent({event:"game_won",callback:function(){e.updateUser({played:e.user.played+1,won:e.user.won+1}),k()("You won!","Play another match! ;)").then(function(t){e._resetGame()})}}),this.registerEvent({event:"game_lost",callback:function(){e.updateUser({played:e.user.played+1,won:e.user.won}),k()("You lost :(","... but you can play again! ;)").then(function(t){e._resetGame()})}}),this.registerEvent({event:"app_error",callback:function(t){var a=t.error;e.messages.push(a)}})}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[e.user?a("div",{staticClass:"player-info"},[e._v("\n    Player: "+e._s(e.user.username)+" | Score: "+e._s(e.user.won)+" wins out of "+e._s(e.user.played)+"\n  ")]):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.user,expression:"user"}],staticClass:"messages-container row"},[a("ul",{staticClass:"col col-xs-12 offset-sm-1 col-sm-10 offset-md-2 col-md-8 offset-lg-3 col-lg-6"},[a("li",{staticClass:"list-group-item notification-container"},[e._v("Notifications")]),e._v(" "),a("li",{directives:[{name:"show",rawName:"v-show",value:0===e.messages.length,expression:"messages.length === 0"}],staticClass:"list-group-item"}),e._v(" "),e._l(e.messages,function(t,s){return a("li",{key:""+s,staticClass:"list-group-item"},[e._v("\n        "+e._s(t)+"\n      ")])})],2)]),e._v(" "),e.match.nextTurnPlayer?a("div",{directives:[{name:"show",rawName:"v-show",value:e.user,expression:"user"}],staticClass:"moves-container"},[a("div",{staticClass:"row"},[a("div",{staticClass:"next-turn-text col col-xs-12 offset-sm-1 col-sm-10 offset-md-2 col-md-8 offset-lg-3 col-lg-6"},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.match.nextTurnPlayer.username,expression:"match.nextTurnPlayer.username"}]},[e._v("\n          Next Turn: "+e._s(e.match.nextTurnPlayer.username)+"\n        ")])])]),e._v(" "),a("div",{staticClass:"row"},[a("ul",{staticClass:"col col-xs-12 offset-sm-1 col-sm-10 offset-md-2 col-md-8 offset-lg-3 col-lg-6"},[a("li",{staticClass:"list-group-item disabled"},[e._v("Player moves")]),e._v(" "),e._l(e.moves,function(t,s){return a("li",{key:""+s,staticClass:"list-group-item"},[t.number&&t.number>0?a("span",[a("b",[e._v(e._s(t.player))]),e._v(" : adding "+e._s(t.added)+" and got: "+e._s(t.number)+"\n        ")]):e._e(),e._v(" "),t.number?e._e():a("span",[a("b",[e._v(e._s(t.player))]),e._v(" : First round, starting with: "+e._s(t.number)+"\n        ")])])})],2)])]):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.user,expression:"user"}],staticClass:"start-game-container"},[a("game-settings",{on:{start_game:e.startGame}})],1)])},staticRenderFns:[]};var P=a("VU/8")(C,x,!1,function(e){a("mdZB")},"data-v-31da1393",null).exports,T={name:"Login",data:function(){return{username:"Michele",password:"password",error:""}},computed:{isUsernameInvalid:function(){return 0===this.username.length},isPasswordInvalid:function(){return 0===this.password.length}},methods:d()({},Object(w.b)("user",{performLogin:"login"}),{login:function(){var e=this;this.performLogin({username:this.username,password:this.password}).then(function(t){e.error="",e.$emit("login_performed",{user:t})}).catch(function(t){var a=t.response;e.error=a.data.error})}}),created:function(){}},E={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"game-settings-container row"},[a("div",{staticClass:"col col-xs-12 offset-sm-1 colsm-10 offset-md-2 col-md-8 offset-lg-4 col-lg-4"},[a("form",{staticClass:"login-form",on:{submit:function(e){e.preventDefault()}}},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-title",attrs:{for:"game-username-input"}},[e._v("Enter your credentials to login")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"form-control",attrs:{type:"text",id:"game-username-input",placeholder:"Enter your username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",id:"game-password-input",placeholder:"Enter your password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),e._v(" "),a("div",{staticClass:"alert-container"},[e.error?a("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v("\n          "+e._s(e.error)+"\n        ")]):e._e()]),e._v(" "),a("button",{staticClass:"btn btn-takeaway-action login-button",attrs:{disabled:e.isUsernameInvalid||e.isPasswordInvalid},on:{click:e.login}},[e._v("\n        Login\n      ")]),e._v(" "),a("router-link",{staticClass:"btn btn-takeaway-primary btn-router login-button",attrs:{to:{name:"Register"}}},[e._v("\n        Register\n      ")])],1)])])},staticRenderFns:[]};var M={components:{Login:a("VU/8")(T,E,!1,function(e){a("y3a5")},"data-v-a118643e",null).exports},name:"Home",data:function(){return{}},methods:{loginPerformed:function(e){j.push({name:"Application"})}}},S={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container"},[this._m(0),this._v(" "),t("login",{on:{login_performed:this.loginPerformed}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"hello"},[t("div",{staticClass:"takeaway-h2"},[this._v("Welcome to the Game of Three ‚Äê Coding Challenge")]),this._v(" "),t("h4",{staticClass:"developed-by"},[this._v("developed by")]),this._v(" "),t("h2",[t("i",[this._v("Michele Angioni")])])])}]};var I=a("VU/8")(M,S,!1,function(e){a("cPRp")},"data-v-d3fe8952",null).exports,N=function(e,t){return l.a.post("http://localhost:3000/sessions",{username:e,password:t})},R=function(e,t){return l.a.post("http://localhost:3000/users",{username:e,password:t})},U={name:"Register",data:function(){return{username:"",password:"",error:"",message:""}},computed:{isUsernameInvalid:function(){return this.username.length<3},isPasswordInvalid:function(){return this.password.length<6}},methods:{register:function(){var e=this;R(this.username,this.password).then(function(t){e.message="You have successfully registered to Game of Three!",setTimeout(function(){j.push({name:"Home"})},3e3)}).catch(function(t){var a=t.response;e.message=a.data.error})}},created:function(){}},G={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"game-settings-container"},[a("div",{staticClass:"col col-xs-12 offset-sm-1 colsm-10 offset-md-2 col-md-8 offset-lg-4 col-lg-4"},[a("form",{staticClass:"registration-form",on:{submit:function(e){e.preventDefault()}}},[a("div",{staticClass:"alert-container"},[e.error?a("div",{staticClass:"alert alert-danger",attrs:{role:"alert"}},[e._v("\n          "+e._s(e.error)+"\n        ")]):e._e(),e._v(" "),e.message?a("div",{staticClass:"alert alert-success",attrs:{role:"alert"}},[e._v("\n          "+e._s(e.message)+"\n        ")]):e._e()]),e._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"takeaway-h2",attrs:{for:"game-username-input"}},[e._v("Register to Game of Three")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"form-control",attrs:{type:"text",id:"game-username-input",placeholder:"Enter your username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),e._v(" "),a("small",{staticClass:"form-error"},[a("div",{staticClass:"form-error"},[e.username.length<6?a("span",[a("i",[e._v("The username must be at least 3 characters long.")])]):e._e()])]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",id:"game-password-input",placeholder:"Enter your password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),a("small",[a("div",{staticClass:"form-error"},[e.password.length<6?a("span",[a("i",[e._v("The password must be at least 6 characters long.")])]):e._e()])])]),e._v(" "),a("button",{staticClass:"btn btn-takeaway-action register-button",attrs:{disabled:e.isUsernameInvalid||e.isPasswordInvalid},on:{click:e.register}},[e._v("\n        Register\n      ")])])])])},staticRenderFns:[]};var A=a("VU/8")(U,G,!1,function(e){a("ff+s")},"data-v-16e87086",null).exports;r.a.use(c.a);var j=new c.a({routes:[{path:"/",name:"Home",component:I},{path:"/application",name:"Application",component:P},{path:"/register",name:"Register",component:A}]}),q=a("DmT9"),$=a.n(q),z={state:{user:null,socket:null},getters:{getUser:function(e){return e.user},getSocket:function(e){return e.socket}},actions:{login:function(e,t){var a=e.commit,s=t.username,r=t.password;return new n.a(function(e,t){N(s,r).then(function(t){a("setUser",t.data.data),e(t.data.data)}).catch(function(e){t(e.response)})})}},mutations:{init:function(e,t){var a=$()("http://localhost:3000/",{path:"/game/?token="+t});e.socket=a},registerSocketEvent:function(e,t){var a=t.event,s=t.callback;e.socket.on(a,s)},setUser:function(e,t){e.user=t},updateUserMatches:function(e,t){var a=t.played,s=t.won;e.user.played=a,e.user.won=s},unsetUser:function(e){e.user=null}}};r.a.use(w.a);var F=new w.a.Store({modules:{user:d()({namespaced:!0},z)},strict:!1});a("SSNS");r.a.config.productionTip=!1,new r.a({el:"#app",store:F,router:j,components:{App:i},template:"<App/>"}),l.a.interceptors.request.use(function(e){return e.headers.common["X-Requested-With"]="XMLHttpRequest",localStorage.getItem("access_token")&&(e.headers.common.Authorization="Bearer "+localStorage.getItem("access_token")),e},function(e){return n.a.reject(e)}),l.a.interceptors.response.use(function(e){return e.headers.authorization&&localStorage.setItem("access_token",e.headers.authorization.substr(7)),e},function(e){return 401===e.response.status&&(localStorage.removeItem("access_token"),j.push({name:"Home"})),n.a.reject(e)})},SSNS:function(e,t){},Zdlp:function(e,t){},aRo5:function(e,t,a){e.exports=a.p+"static/img/takeawaylogo.7e416ef.png"},cPRp:function(e,t){},"ff+s":function(e,t){},j3lA:function(e,t){},mdZB:function(e,t){},y3a5:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.ab01dd182dfa21303959.js.map